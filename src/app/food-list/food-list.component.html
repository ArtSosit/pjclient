<div class="input-group mb-3">
  <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏ô‡∏π -->
  <input
    type="text"
    class="form-control"
    [(ngModel)]="searchText"
    (ngModelChange)="filterMenus()"
    placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏°‡∏ô‡∏π..."
  />

  <!-- ‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà -->
  <select
    class="form-select"
    [(ngModel)]="selectedCategory"
    (ngModelChange)="filterMenus()"
  >
    <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
    <option *ngFor="let cate of categories" [value]="cate.category_name">
      {{ cate.category_name }}
    </option>
  </select>
</div>
<ng-container *ngIf="filteredMenus.length > 0">
  <div class="recommended-menu" *ngIf="recommendedMenusExist()">
    <h2>üåü ‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h2>
    <ng-container *ngFor="let menu of filteredMenus">
      <div
        class="menu-card mb-3"
        *ngIf="menu.is_recommended === 1"
        [ngClass]="{ disabled: menu.status === 'unavailable' }"
        (click)="menu.status === 'available' ? openModal(menu) : null"
      >
        <img alt="menu-item" class="menu-image" [src]="menu.imageUrl" />
        <div class="menu-content">
          <span
            *ngIf="isBestSeller(menu.item_id)"
            class="badge bestseller-badge"
            >üî• ‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ</span
          >
          <h3>{{ menu.item_name }}</h3>
          <p>{{ menu.category }}</p>
          <p *ngIf="menu.status === 'unavailable'" class="sold-out">
            ‚ùå ‡∏´‡∏°‡∏î‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß
          </p>
          <p *ngIf="menu.discount > 0" class="discount">
            ‡∏•‡∏î {{ menu.discount }} ‡∏ö‡∏≤‡∏ó
          </p>
          <p>
            ‡∏£‡∏≤‡∏Ñ‡∏≤:
            <span *ngIf="menu.discount > 0" class="original-price"
              >{{ menu.price | number : "1.2-2" }} ‡∏ö‡∏≤‡∏ó</span
            >
            <span *ngIf="menu.discount > 0" class="discounted-price">
              {{
                getDiscountedPrice(menu.price, menu.discount) | number : "1.2-2"
              }}
              ‡∏ö‡∏≤‡∏ó
            </span>
            <span *ngIf="menu.discount === 0 || menu.discount === null"
              >{{ menu.price | number : "1.2-2" }} ‡∏ö‡∏≤‡∏ó</span
            >
          </p>
        </div>
      </div>
    </ng-container>
  </div>
</ng-container>

<!-- üçΩÔ∏è ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡∏õ‡∏Å‡∏ï‡∏¥ -->
<ng-container *ngIf="filteredMenus.length > 0">
  <div class="all-menu">
    <h2>üçΩÔ∏è ‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
    <ng-container *ngFor="let menu of filteredMenus">
      <div
        class="menu-card mb-3"
        *ngIf="menu.is_recommended === 0"
        [ngClass]="{ disabled: menu.status === 'unavailable' }"
        (click)="openModal(menu)"
      >
        <img alt="menu-item" class="menu-image" [src]="menu.imageUrl" />
        <div class="menu-content">
          <span
            *ngIf="isBestSeller(menu.item_id)"
            class="badge bestseller-badge"
            >üî• ‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ</span
          >
          <h3>{{ menu.item_name }}</h3>
          <p>{{ menu.category }}</p>
          <p *ngIf="menu.status === 'unavailable'" class="sold-out">
            ‚ùå ‡∏´‡∏°‡∏î‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß
          </p>
          <p *ngIf="menu.discount > 0" class="discount">
            ‡∏•‡∏î {{ menu.discount }} ‡∏ö‡∏≤‡∏ó
          </p>
          <p>
            ‡∏£‡∏≤‡∏Ñ‡∏≤:
            <span *ngIf="menu.discount > 0" class="original-price"
              >{{ menu.price | number : "1.2-2" }} ‡∏ö‡∏≤‡∏ó</span
            >
            <span *ngIf="menu.discount > 0" class="discounted-price">
              {{
                getDiscountedPrice(menu.price, menu.discount) | number : "1.2-2"
              }}
              ‡∏ö‡∏≤‡∏ó
            </span>
            <span *ngIf="menu.discount === 0 || menu.discount === null"
              >{{ menu.price | number : "1.2-2" }} ‡∏ö‡∏≤‡∏ó</span
            >
          </p>
        </div>
      </div>
    </ng-container>
  </div>
</ng-container>

<!--car Modal -->
<div *ngIf="selectedMenu" class="modal-backdrop">
  <div class="modal-container">
    <div class="modal-header">
      <h2>{{ selectedMenu.item_name }}</h2>
      <button type="button" class="close-btn" (click)="closeModal()">
        &times;
      </button>
    </div>

    <div class="modal-body" style="text-align: center">
      <img
        [src]="selectedMenu.imageUrl"
        alt="menu image"
        class="menu-image"
        style="width: 100%; height: auto"
      />

      <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤ -->
      <p>
        ‡∏£‡∏≤‡∏Ñ‡∏≤:
        <span *ngIf="selectedMenu.discount > 0" class="original-price">
          {{ selectedMenu.price | number : "1.2-2" }} ‡∏ö‡∏≤‡∏ó
        </span>
        <span *ngIf="selectedMenu.discount > 0" class="discounted-price">
          {{
            getDiscountedPrice(selectedMenu.price, selectedMenu.discount)
              | number : "1.2-2"
          }}
          ‡∏ö‡∏≤‡∏ó
        </span>
        <span *ngIf="selectedMenu.discount === 0">
          {{ selectedMenu.price | number : "1.2-2" }} ‡∏ö‡∏≤‡∏ó
        </span>
      </p>

      <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô -->
      <div class="quantity-container">
        <button class="quantity-btn" (click)="decreaseQuantity()">-</button>
        <input
          type="number"
          [(ngModel)]="quantity"
          (change)="validateQuantity()"
          class="quantity-input"
        />
        <button class="quantity-btn" (click)="increaseQuantity()">+</button>
      </div>

      <!-- ‚úÖ ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° -->
      <div class="option-container">
        <label for="note">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°:</label>
        <textarea
          id="note"
          [(ngModel)]="additionalNote"
          rows="3"
          placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏û‡∏£‡∏¥‡∏Å, ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏µ‡∏™"
        ></textarea>
      </div>

      <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏Å‡πá‡∏ö‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ -->
      <button class="add-to-cart-btn" (click)="addToCart()">
        ‡πÄ‡∏Å‡πá‡∏ö‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
      </button>
    </div>
  </div>
</div>
